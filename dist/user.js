'use strict';

var uuidV4 = require('uuid/v4');
var validateString = require('./private/helpers.js').validateString;

var idPrefix = "pathwaycommons-js-lib:";

var _id = new WeakMap();
var key = {};

var setId = function setId(userId) {
  if (validateString(userId)) {
    userId = idPrefix + userId;
  } else if (userId === null) {
    userId = "";
  } else {
    userId = idPrefix + uuidV4();
  }

  if (_id.get(key) === undefined) {
    _id.set(key, userId);
  }
};

module.exports = {
  id: function id(userId) {
    if (!(userId === undefined && _id.get(key) !== undefined)) {
      setId(userId);
    }
    return _id.get(key);
  }
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInVzZXIuanMiXSwibmFtZXMiOlsidXVpZFY0IiwicmVxdWlyZSIsInZhbGlkYXRlU3RyaW5nIiwiaWRQcmVmaXgiLCJfaWQiLCJXZWFrTWFwIiwia2V5Iiwic2V0SWQiLCJ1c2VySWQiLCJnZXQiLCJ1bmRlZmluZWQiLCJzZXQiLCJtb2R1bGUiLCJleHBvcnRzIiwiaWQiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBLElBQUlBLFNBQVNDLFFBQVEsU0FBUixDQUFiO0FBQ0EsSUFBSUMsaUJBQWlCRCxRQUFRLHNCQUFSLEVBQWdDQyxjQUFyRDs7QUFFQSxJQUFNQyxXQUFXLHdCQUFqQjs7QUFFQSxJQUFNQyxNQUFNLElBQUlDLE9BQUosRUFBWjtBQUNBLElBQU1DLE1BQU0sRUFBWjs7QUFFQSxJQUFNQyxRQUFRLFNBQVJBLEtBQVEsQ0FBQ0MsTUFBRCxFQUFZO0FBQ3hCLE1BQUlOLGVBQWVNLE1BQWYsQ0FBSixFQUE0QjtBQUMxQkEsYUFBU0wsV0FBV0ssTUFBcEI7QUFDRCxHQUZELE1BR0ssSUFBSUEsV0FBVyxJQUFmLEVBQXFCO0FBQ3hCQSxhQUFTLEVBQVQ7QUFDRCxHQUZJLE1BR0E7QUFDSEEsYUFBU0wsV0FBV0gsUUFBcEI7QUFDRDs7QUFFRCxNQUFHSSxJQUFJSyxHQUFKLENBQVFILEdBQVIsTUFBaUJJLFNBQXBCLEVBQStCO0FBQzdCTixRQUFJTyxHQUFKLENBQVFMLEdBQVIsRUFBYUUsTUFBYjtBQUNEO0FBQ0YsQ0FkRDs7QUFnQkFJLE9BQU9DLE9BQVAsR0FBaUI7QUFDZkMsTUFBSSxZQUFDTixNQUFELEVBQVk7QUFDZCxRQUFHLEVBQUdBLFdBQVdFLFNBQVosSUFBMkJOLElBQUlLLEdBQUosQ0FBUUgsR0FBUixNQUFpQkksU0FBOUMsQ0FBSCxFQUE4RDtBQUM1REgsWUFBTUMsTUFBTjtBQUNEO0FBQ0QsV0FBT0osSUFBSUssR0FBSixDQUFRSCxHQUFSLENBQVA7QUFDRDtBQU5jLENBQWpCIiwiZmlsZSI6InVzZXIuanMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbnZhciB1dWlkVjQgPSByZXF1aXJlKCd1dWlkL3Y0Jyk7XG52YXIgdmFsaWRhdGVTdHJpbmcgPSByZXF1aXJlKCcuL3ByaXZhdGUvaGVscGVycy5qcycpLnZhbGlkYXRlU3RyaW5nO1xuXG5jb25zdCBpZFByZWZpeCA9IFwicGF0aHdheWNvbW1vbnMtanMtbGliOlwiO1xuXG5jb25zdCBfaWQgPSBuZXcgV2Vha01hcCgpO1xuY29uc3Qga2V5ID0ge307XG5cbmNvbnN0IHNldElkID0gKHVzZXJJZCkgPT4ge1xuICBpZiAodmFsaWRhdGVTdHJpbmcodXNlcklkKSkge1xuICAgIHVzZXJJZCA9IGlkUHJlZml4ICsgdXNlcklkO1xuICB9XG4gIGVsc2UgaWYgKHVzZXJJZCA9PT0gbnVsbCkge1xuICAgIHVzZXJJZCA9IFwiXCI7XG4gIH1cbiAgZWxzZSB7XG4gICAgdXNlcklkID0gaWRQcmVmaXggKyB1dWlkVjQoKTtcbiAgfVxuXG4gIGlmKF9pZC5nZXQoa2V5KSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgX2lkLnNldChrZXksIHVzZXJJZCk7XG4gIH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSB7XG4gIGlkOiAodXNlcklkKSA9PiB7XG4gICAgaWYoISgodXNlcklkID09PSB1bmRlZmluZWQpICYmIChfaWQuZ2V0KGtleSkgIT09IHVuZGVmaW5lZCkpKSB7XG4gICAgICBzZXRJZCh1c2VySWQpO1xuICAgIH1cbiAgICByZXR1cm4gX2lkLmdldChrZXkpO1xuICB9XG59XG4iXX0=