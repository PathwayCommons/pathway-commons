'use strict';

var uuidV4 = require('uuid/v4');
var validateString = require('./private/helpers.js').validateString;

var idPrefix = "pathwaycommons-js-lib:";

var _id = new WeakMap();

var setId = function setId(userId) {
  if (validateString(userId)) {
    userId = idPrefix + userId;
  } else if (userId === null) {
    userId = "";
  } else {
    userId = idPrefix + uuidV4();
  }

  if (_id.get(undefined) === undefined) {
    _id.set(undefined, userId);
  }
};

module.exports = {
  id: function id(userId) {
    if (!(userId === undefined && _id.get(undefined) !== undefined)) {
      setId(userId);
    }
    return _id.get(undefined);
  }
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInVzZXIuanMiXSwibmFtZXMiOlsidXVpZFY0IiwicmVxdWlyZSIsInZhbGlkYXRlU3RyaW5nIiwiaWRQcmVmaXgiLCJfaWQiLCJXZWFrTWFwIiwic2V0SWQiLCJ1c2VySWQiLCJnZXQiLCJ1bmRlZmluZWQiLCJzZXQiLCJtb2R1bGUiLCJleHBvcnRzIiwiaWQiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBLElBQUlBLFNBQVNDLFFBQVEsU0FBUixDQUFiO0FBQ0EsSUFBSUMsaUJBQWlCRCxRQUFRLHNCQUFSLEVBQWdDQyxjQUFyRDs7QUFFQSxJQUFNQyxXQUFXLHdCQUFqQjs7QUFFQSxJQUFJQyxNQUFNLElBQUlDLE9BQUosRUFBVjs7QUFFQSxJQUFNQyxRQUFRLFNBQVJBLEtBQVEsQ0FBQ0MsTUFBRCxFQUFZO0FBQ3hCLE1BQUlMLGVBQWVLLE1BQWYsQ0FBSixFQUE0QjtBQUMxQkEsYUFBU0osV0FBV0ksTUFBcEI7QUFDRCxHQUZELE1BR0ssSUFBSUEsV0FBVyxJQUFmLEVBQXFCO0FBQ3hCQSxhQUFTLEVBQVQ7QUFDRCxHQUZJLE1BR0E7QUFDSEEsYUFBU0osV0FBV0gsUUFBcEI7QUFDRDs7QUFFRCxNQUFHSSxJQUFJSSxHQUFKLGdCQUFrQkMsU0FBckIsRUFBZ0M7QUFDOUJMLFFBQUlNLEdBQUosWUFBY0gsTUFBZDtBQUNEO0FBQ0YsQ0FkRDs7QUFnQkFJLE9BQU9DLE9BQVAsR0FBaUI7QUFDZkMsTUFBSSxZQUFDTixNQUFELEVBQVk7QUFDZCxRQUFHLEVBQUdBLFdBQVdFLFNBQVosSUFBMkJMLElBQUlJLEdBQUosZ0JBQWtCQyxTQUEvQyxDQUFILEVBQStEO0FBQzdESCxZQUFNQyxNQUFOO0FBQ0Q7QUFDRCxXQUFPSCxJQUFJSSxHQUFKLFdBQVA7QUFDRDtBQU5jLENBQWpCIiwiZmlsZSI6InVzZXIuanMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbnZhciB1dWlkVjQgPSByZXF1aXJlKCd1dWlkL3Y0Jyk7XG52YXIgdmFsaWRhdGVTdHJpbmcgPSByZXF1aXJlKCcuL3ByaXZhdGUvaGVscGVycy5qcycpLnZhbGlkYXRlU3RyaW5nO1xuXG5jb25zdCBpZFByZWZpeCA9IFwicGF0aHdheWNvbW1vbnMtanMtbGliOlwiO1xuXG52YXIgX2lkID0gbmV3IFdlYWtNYXAoKTtcblxuY29uc3Qgc2V0SWQgPSAodXNlcklkKSA9PiB7XG4gIGlmICh2YWxpZGF0ZVN0cmluZyh1c2VySWQpKSB7XG4gICAgdXNlcklkID0gaWRQcmVmaXggKyB1c2VySWQ7XG4gIH1cbiAgZWxzZSBpZiAodXNlcklkID09PSBudWxsKSB7XG4gICAgdXNlcklkID0gXCJcIjtcbiAgfVxuICBlbHNlIHtcbiAgICB1c2VySWQgPSBpZFByZWZpeCArIHV1aWRWNCgpO1xuICB9XG5cbiAgaWYoX2lkLmdldCh0aGlzKSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgX2lkLnNldCh0aGlzLCB1c2VySWQpO1xuICB9XG59XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICBpZDogKHVzZXJJZCkgPT4ge1xuICAgIGlmKCEoKHVzZXJJZCA9PT0gdW5kZWZpbmVkKSAmJiAoX2lkLmdldCh0aGlzKSAhPT0gdW5kZWZpbmVkKSkpIHtcbiAgICAgIHNldElkKHVzZXJJZCk7XG4gICAgfVxuICAgIHJldHVybiBfaWQuZ2V0KHRoaXMpO1xuICB9XG59XG4iXX0=